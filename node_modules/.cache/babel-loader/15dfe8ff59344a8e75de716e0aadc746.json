{"ast":null,"code":"import _slicedToArray from\"/Users/assetmurzabayev/Desktop/react-mesto-auth/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from'react';import{Route,Switch,Redirect,useHistory}from\"react-router-dom\";import Header from'./Header.js';import Login from'./Login.js';import Register from'./Register.js';import InfoToolTip from'./InfoToolTip.js';import ProtectedRoute from'./ProtectedRoute.js';import Elements from'./Elements.js';import*as Auth from'../Auth.js';function App(){var _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),loggedIn=_React$useState2[0],setLoggedIn=_React$useState2[1];var _React$useState3=React.useState(''),_React$useState4=_slicedToArray(_React$useState3,2),userData=_React$useState4[0],setUserData=_React$useState4[1];var _React$useState5=React.useState(false),_React$useState6=_slicedToArray(_React$useState5,2),isInfoToolOpen=_React$useState6[0],setIsInfoToolOpen=_React$useState6[1];var _React$useState7=React.useState(false),_React$useState8=_slicedToArray(_React$useState7,2),successRegister=_React$useState8[0],setSuccessRegister=_React$useState8[1];var history=useHistory();function handleInfoToolPopup(){setIsInfoToolOpen(true);}function handleSuccessRegister(){setSuccessRegister(true);}function handleLogin(){setLoggedIn(true);}function closePopup(){setIsInfoToolOpen(false);}function tokenCheck(){if(localStorage.getItem('jwt')){var jwt=localStorage.getItem('jwt');Auth.getContent(jwt).then(function(res){if(res.data){setLoggedIn(true);setUserData(res.data.email);history.push('/');}}).catch(function(err){console.log(err);});}}React.useEffect(function(){tokenCheck();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[loggedIn]);function signOut(){localStorage.removeItem('jwt');history.push('/signin');setLoggedIn(false);setUserData('');}return/*#__PURE__*/React.createElement(\"div\",{className:\"App\"},/*#__PURE__*/React.createElement(\"div\",{className:\"page\"},/*#__PURE__*/React.createElement(Header,{signOut:signOut,userData:userData}),/*#__PURE__*/React.createElement(InfoToolTip,{isOpen:isInfoToolOpen,success:successRegister,onClose:closePopup},\" \"),/*#__PURE__*/React.createElement(Switch,null,/*#__PURE__*/React.createElement(ProtectedRoute,{exact:true,path:\"/\",loggedIn:loggedIn,component:Elements}),/*#__PURE__*/React.createElement(Route,{path:\"/signup\"},\" \",/*#__PURE__*/React.createElement(Register,{handlePopup:handleInfoToolPopup,successRegister:handleSuccessRegister}),\"  \"),/*#__PURE__*/React.createElement(Route,{path:\"/signin\"},\" \",/*#__PURE__*/React.createElement(Login,{handleLogin:handleLogin,tokenCheck:tokenCheck}),\"  \"),/*#__PURE__*/React.createElement(Route,null,\" \",loggedIn?/*#__PURE__*/React.createElement(Redirect,{to:\"/\"}):/*#__PURE__*/React.createElement(Redirect,{to:\"/signin\"}),\" \"))));}export default App;","map":{"version":3,"sources":["/Users/assetmurzabayev/Desktop/react-mesto-auth/src/components/App.js"],"names":["React","Route","Switch","Redirect","useHistory","Header","Login","Register","InfoToolTip","ProtectedRoute","Elements","Auth","App","useState","loggedIn","setLoggedIn","userData","setUserData","isInfoToolOpen","setIsInfoToolOpen","successRegister","setSuccessRegister","history","handleInfoToolPopup","handleSuccessRegister","handleLogin","closePopup","tokenCheck","localStorage","getItem","jwt","getContent","then","res","data","email","push","catch","err","console","log","useEffect","signOut","removeItem"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { Route, Switch, Redirect, useHistory } from \"react-router-dom\";\nimport Header from './Header.js';\nimport Login from './Login.js';\nimport Register from './Register.js';\nimport InfoToolTip from './InfoToolTip.js';\nimport ProtectedRoute from './ProtectedRoute.js';\nimport Elements from './Elements.js';\nimport * as Auth from '../Auth.js';\n\nfunction App() {\n\n  const [loggedIn, setLoggedIn] = React.useState(false);\n  const [userData, setUserData] = React.useState('');\n  const [isInfoToolOpen, setIsInfoToolOpen] = React.useState(false);\n  const [successRegister, setSuccessRegister] = React.useState(false);\n\n  const history = useHistory();\n\n  function handleInfoToolPopup() {\n    setIsInfoToolOpen(true);\n  }\n\n  function handleSuccessRegister() {\n    setSuccessRegister(true);\n  }\n\n  function handleLogin() {\n    setLoggedIn(true);\n  }\n\n  function closePopup() {\n    setIsInfoToolOpen(false)\n  }\n\n  function tokenCheck() {\n    if (localStorage.getItem('jwt')) {\n      let jwt = localStorage.getItem('jwt');\n      Auth.getContent(jwt)\n        .then((res) => {\n          if (res.data) {\n            setLoggedIn(true); \n            setUserData(res.data.email); \n            history.push('/');\n          }\n        })\n        .catch((err) => {\n          console.log(err);\n        })\n    }\n  }\n\n   React.useEffect(() => {\n    tokenCheck();\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [loggedIn]) \n\n\n  function signOut() {\n    localStorage.removeItem('jwt');\n    history.push('/signin')\n    setLoggedIn(false);\n     setUserData('');\n  }\n\n  return (\n\n      <div className=\"App\">\n        <div className=\"page\">  \n\n          <Header signOut={signOut} userData={userData}/>\n\n          <InfoToolTip isOpen={isInfoToolOpen} success={successRegister} onClose={closePopup} > </InfoToolTip>\n  \n          <Switch>\n\n            <ProtectedRoute exact path=\"/\" loggedIn={loggedIn} component={Elements} />\n\n            <Route  path=\"/signup\"> <Register handlePopup={handleInfoToolPopup} successRegister={handleSuccessRegister} />  </Route>\n\n            <Route  path=\"/signin\"> <Login handleLogin={handleLogin} tokenCheck={tokenCheck}/>  </Route>\n\n            <Route> {loggedIn ? <Redirect to=\"/\" /> : <Redirect to='/signin' />} </Route>\n            \n\n            </Switch>\n\n\n      </div>  \n    </div>\n\n  );\n\n}\n\nexport default App;"]},"metadata":{},"sourceType":"module"}